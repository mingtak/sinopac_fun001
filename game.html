<!DOCTYPE HTML>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,Chrome=1">
    <meta http-equiv="Cache-Control" content="no-cache" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <meta property="og:title" content="永豐銀行" />
    <meta property="og:image" content=""/>
    <meta property="og:url" content="" />
    <meta property="og:description" content="" />
    <meta name="keywords" content=""/>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>永豐銀行</title>
    <link rel="shortcut icon" href="https://mma.sinopac.com/images/favicon.ico" />
    <link href="css/reset.css" rel="stylesheet" type="text/css">
    <link href="css/jquery-ui.css" rel="stylesheet" type="text/css">
    <link href="css/site-light.css" rel="stylesheet" type="text/css">
    <link href="css/custom.css" rel="stylesheet" type="text/css">
    <script src="js/jquery-latest.min.js" type="text/javascript"></script>
    <script src="js/jquery-ui.js" type="text/javascript"></script>
    <script src="js/jquery.lightbox_me.js" type="text/javascript"></script>
    <script src="js/upgrade-remind.js" type="text/javascript"></script>
    <script src="js/site-light.js" type="text/javascript"></script>
    <script src="js/vue.min.js" type="text/javascript"></script>
<!--    <script src="js/vue.drag-and-drop.js"></script> -->
  </head>
  <body>
    <div class="big-container">
      <div class="wrapper">
        <div class="wrapper_1"></div>

        <header>
          <div class="header-top">
            <div class="container">
              <div class="left-pane">
                <div class="logo">
                  <a target="_blank" href="https://bank.sinopac.com/bsp/index/index.asp" title="永豐銀行首頁">
                    <img class="hidden-min" src="images/sinopac_logo.png" alt="永豐銀行"/>
                    <img class="hidden-max" src="images/sinopac_logo_320.png" alt="永豐銀行">
                  </a>
                </div>
              </div>
              <div class="clearboth"></div>
            </div>
          </div>
        </header>
        <div class="body-container game">
          <div id="fun001-main" class="container game-area">
            <section class="store">
              <fieldset class="case">
                <legend></legend>
<!-- 商品架 -->
                <ul class="products">
                  <li class="product"
                      ondrop="drop(event)"
                      ondragover="allowDrop(event)"
                      v-for="item in items">

                      <div v-bind:id="item.pid" draggable="true" ondragstart="drag(event)" class="prod">
                          <div class="item">
                              <img  v-bind:src="item.src" v-bind:alt="item.t1 + item.t2">
                          </div>
                          <div class="sign">
                              <p class="t1">{{ item.t1 }}</p>
                              <p class="t2">{{ item.t2}}</p>
                              <p class="nt">
                                  <span>NT$</span>
                                  <span class="money">{{ item.money }}</span>
                              </p>
                          </div>
                      </div>

                  </li>
                </ul>
              </fieldset>
            </section>
            <section class="checkout-table">
              <div class="prods">
<!-- 購物車 -->
                <ul class="products">
                  <li v-for="result in r_area"
                      v-bind:id="result.rid"
                      class="result-area"
                      ondrop="drop(event)"
                      ondragover="allowDrop(event)">
                  </li>
                </ul>
              </div>
              <div class="checkout">
                <div class="dashboard">
                  <div class="top"><i class="timer"></i><span id="time_counter" class="count">{{ timer }}</span> 秒</div>
                  <div class="middle">
                    <p class="title">目前累積金額達</p>
                    <p>NT$<span class="total-money">{{ result_total }}</span>元</p>
                  </div>
                  <div class="bottom">
                    <p>目標金額NT$<span class="target-money">1688</span>元</p>
                  </div>
                </div>
                <div class="exit">
                  <a id="success" href="javascript: void(0)" class="submit" onClick="stopCount()" style="max-width:107px">完成<br>送出</a>
                  <a href="game.html" class="reset" style="width:107px">重新開始</a>
                </div>
              </div>
              <p class="info">*本畫面商品資訊及購買流程僅為遊戲設計，欲了解實際商品詳情請至<a target="_target" href="#">永豐商店紅包網</a></p>
            </section>
          </div>
        </div>
        <script>
        $(document).ready(function(){
          openLbox('#mission-readme');
        });
        </script>
        <footer class="footer">
          <div class="copyright hidden-min"><p>©版權所有永豐銀行   建議瀏覽器IE11.0以上/解析度1024*768           <a target="_blank" href="https://bank.sinopac.com/MMA8/bank/service/service-index.html">客服中心</a></p></div>        
          <div class="copyright hidden-max"><p>© 版權所有永豐銀行</p></div>
        </footer>
    
      </div>
    </div>
    <div class="lboxed">
      <div class="close"></div>
      <div class="lbox-block">
        <div id="mission-readme" class="mission-readme">
          <h2>遊戲任務說明</h2>
          <div class="desc-block">
            <p>20秒內點選<span class="upper">3</span>樣商品</p>
            <p class="red">累計金額為 $1688</p>
          </div>
          <div class="btn-block">
            <a href="#" class="close start-game" onClick="timedCount()">開始遊戲</a>
          </div>
        </div>
        <div id="finish" class="finish">
          <h2>完成任務成績</h2>
          <div class="desc-block">
            <div class="desc1">
              <p><span class="sec-result">18.30</span> 秒</p>
              <div class="btn-block inline">
                <a class="try-again" href="#">再玩一次</a>
              </div>
            </div>
            <div class="desc2">
              <p>恭喜您~於<span class="red">20秒內</span>完成任務!</p>
              <p>獲得「與型男大廚吳秉承一起做好菜」抽獎機會</p>
              <p>【立即填寫資料參加抽獎】</p>
            </div>
            <div class="desc3">
              <table>
                <tbody>
                  <tr>
                    <th>我已是豐掌櫃會員</th>
                    <td><input type="text"></td>
                    <td><a href="#">立即加</a></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

<script>
$('#success').hide();
var vm = new Vue({
    el: '#fun001-main',

    data: {
        items: [
            { pid:'P_01', t1:'永豐餘生技1', t2:'有機黑豆蔭油禮盒1', money:500, src:'images/stuffs/2.png' },
            { pid:'P_02', t1:'永豐餘生技2', t2:'有機黑豆蔭油禮盒2', money:957, src:'images/stuffs/4.png' },
            { pid:'P_03', t1:'永豐餘生技3', t2:'有機黑豆蔭油禮盒3', money:334, src:'images/stuffs/1.png' },
            { pid:'P_04', t1:'永豐餘生技4', t2:'有機黑豆蔭油禮盒4', money:725, src:'images/stuffs/4.png' },
            { pid:'P_05', t1:'永豐餘生技5', t2:'有機黑豆蔭油禮盒5', money:327, src:'images/stuffs/2.png' },
            { pid:'P_06', t1:'永豐餘生技6', t2:'有機黑豆蔭油禮盒6', money:500, src:'images/stuffs/1.png' },
            { pid:'P_07', t1:'永豐餘生技7', t2:'有機黑豆蔭油禮盒7', money:924, src:'images/stuffs/3.png' },
            { pid:'P_08', t1:'永豐餘生技8', t2:'有機黑豆蔭油禮盒8', money:688, src:'images/stuffs/1.png' },
            { pid:'P_09', t1:'永豐餘生技9', t2:'有機黑豆蔭油禮盒9', money:824, src:'images/stuffs/4.png' },
            { pid:'P_10', t1:'永豐餘生技10', t2:'有機黑豆蔭油禮盒10', money:1023, src:'images/stuffs/2.png' },
          ],
        r_area: [
            { rid:'r01', },
            { rid:'r02', },
            { rid:'r03', },
        ],
        result_total: 0,
        timer: 0,
        display: 'visibility:hidden',
    },

    methods: {
        totalSum: function (obj) {
            r01Price = 0;
            r02Price = 0;
            r03Price = 0;

            if(document.getElementById('r01').children.length > 0){
                r01Price = Number(document.getElementById('r01').getElementsByClassName('money')[0].innerHTML);
            }
            if(document.getElementById('r02').children.length > 0){
                r02Price = Number(document.getElementById('r02').getElementsByClassName('money')[0].innerHTML);
            }
            if(document.getElementById('r03').children.length > 0){
                r03Price = Number(document.getElementById('r03').getElementsByClassName('money')[0].innerHTML);
            }
            total = r01Price + r02Price + r03Price;
            vm.result_total = total;
        },

        moveObj: function (obj) {
            c_r01 = $('#r01')[0];
            c_r02 = $('#r02')[0];
            c_r03 = $('#r03')[0];

            c_name = obj.parentNode.getAttribute('class');
            cart = $('li.product');

            if(c_name == 'product'){
                if(c_r01.children.length == 0){
                    c_r01.appendChild(obj);
                }else if(c_r02.children.length == 0){
                    c_r02.appendChild(obj);
                }else if(c_r03.children.length == 0){
                    c_r03.appendChild(obj);
                }
            }else if(c_name == 'result-area'){

                for(i=0; i<cart.length; i++){
                    if(cart[i].children.length == 0){
                        cart[i].appendChild(obj);
                    }
                }
            }
            vm.totalSum();
            if(vm.timer < 18 && vm.result_total == 1688){
                $('#success').show('slow');
            }else{
                $('#success').hide('slow');
            }
        },
    },
})


</script>

<!-- Drag and Drop -->
<script>
function allowDrop(ev){
    ev.preventDefault();
}

function drag(ev){
    ev.dataTransfer.setData("Text",ev.target.id);
}

function drop(ev){
    ev.preventDefault();
    var data=ev.dataTransfer.getData("Text");

    // 檢查裏面是否已有物品
    if(ev.target.nodeName == 'LI' && ev.target.children.length == 0){
        ev.target.appendChild(document.getElementById(data));
        vm.totalSum();
        if(vm.timer < 18 && vm.result_total == 1688){
            $('#success').show('slow');
        }else{
            $('#success').hide('slow');
        }
    }
}
</script>

<!-- Timer -->
<script type="text/javascript">
    var c=0;
    var t;
    function timedCount(){
        vm.timer = vm.timer+1;
        t=setTimeout("timedCount()",1000);
    }

    function stopCount(){
        setTimeout("document.getElementById('time_counter').innerHTML=vm.timer",0);
        clearTimeout(t);
        // 確認18秒內完成
        if(vm.timer < 18 && vm.result_total == 1688){
            openLbox('#finish');
        }
    }


// TODO: 完成送參數出去
</script>

<!-- 手機/平板 touchstart event -->
<script>

    window.addEventListener('load', function(){ // on page load
        el = $('li div.prod');
        for(i=0; i<el.length ; i++){
            el[i].addEventListener('touchend', function(e){
                vm.moveObj(this);
            }, false);
        }
    }, false)

</script>

  </body>
</html>
